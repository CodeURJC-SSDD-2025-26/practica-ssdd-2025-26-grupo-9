<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Perfil</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body class="d-flex flex-column min-vh-100" style="background-color: #f4e4bc;">

<header>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container">
            <a class="navbar-brand fw-bold" href="home.html">OneDeck</a>
        </div>
    </nav>
</header>
    
<main class="flex-grow-1 py-4">
  <div class="container">
    <div class="row">

      <!-- PERFIL (izquierda) -->
      <div class="col-md-7 col-lg-6">
        <div class="card shadow border-0">
          <div class="card-header bg-white py-3">
            <h1 class="h4 mb-0 text-secondary text-center">Perfil</h1>
          </div>

          <div class="card-body d-flex align-items-center gap-4">
            <img id="profile-image" src="/profileimages/OpeOpeNoMi.webp"
              class="rounded-circle border"
              style="width: 96px; height: 96px; object-fit: cover;">

            <div class="flex-grow-1">
              <h2 id="profile-name" class="h5 mb-1">María García</h2>
              <p class="mb-2 text-muted">Rol: <span class="fw-semibold">Admin</span></p>
              <p class="mb-0">
                <span class="text-muted">Correo:</span>
                <a id="profile-email" href="mailto:maria@example.com">maria@example.com</a>
              </p>
              <div class="mt-3 d-grid">
                <a href="editUser.html" class="btn btn-primary fw-bold">Editar perfil</a>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- GRÁFICA (derecha) -->
      <div class="col-md-6 col-lg-4 offset-lg-2">
        <div class="card shadow border-0">
          <div class="card-header bg-white text-center fw-bold">Cartas favoritas</div>
          <div class="card-body text-center">
            <canvas id="favCardsChart" style="max-width:300px; max-height:300px;"></canvas>
          </div>
        </div>
      </div>

    </div>
  </div>
</main>

<script>
window.addEventListener('DOMContentLoaded', () => {
    const savedUser = localStorage.getItem('currentUser');
    if (savedUser) {
        const user = JSON.parse(savedUser);
        document.getElementById('profile-name').textContent = user.name;
        document.getElementById('profile-email').textContent = user.email;
        document.getElementById('profile-email').href = 'mailto:' + user.email;
        if (user.image) document.getElementById('profile-image').src = user.image;
    }

    const ctx = document.getElementById('favCardsChart');
    new Chart(ctx, {
        type: 'pie',
        data: {
            labels: ['Chopper', 'Luffy', 'Robin'],
            datasets: [{
                data: [6, 4, 3],
                backgroundColor: ['#ff6384', '#36a2eb', '#ffcd56']
            }]
        }
    });
});
</script>

</body>
</html>
